# **ğŸ“Œ Node.js Architecture (Interview Guide)**

## **1ï¸âƒ£ What is Node.js Architecture?**

Node.js follows an  **event-driven, single-threaded, non-blocking I/O model** , making it highly scalable for real-time applications. It uses the **V8 engine** to execute JavaScript and **libuv** for asynchronous I/O operations.

---

## **2ï¸âƒ£ Key Components of Node.js Architecture**

1ï¸âƒ£ **V8 Engine** â€“ Executes JavaScript code (compiles it to machine code).

2ï¸âƒ£ **Event Loop** â€“ Manages asynchronous operations using callbacks.

3ï¸âƒ£ **libuv** â€“ Handles threading, event loop, and async I/O.

4ï¸âƒ£ **Non-blocking I/O** â€“ Allows multiple tasks without waiting.

5ï¸âƒ£ **APIs & Modules** â€“ Built-in and third-party modules (e.g., `fs`, `http`, `express`).

---

## **3ï¸âƒ£ Node.js Architecture Diagram**

```
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚        JavaScript Code        â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚          V8 Engine           â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚           libuv               â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
           â”‚  Thread  â”‚  Async   â”‚ Timers â”‚
           â”‚  Pool    â”‚  I/O Ops â”‚ etc.   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚        Event Loop             â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
           â”‚  Timers  â”‚ Callbacksâ”‚  I/O    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚        Application Code      â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## **4ï¸âƒ£ How Node.js Works Internally?**

### **ğŸ”¹ Step 1: Accepting Requests**

* When a client makes an HTTP request, it goes to the  **event loop** .
* If it is a **blocking operation** (e.g., file system read, database call), it is **delegated** to libuv.

### **ğŸ”¹ Step 2: Handling I/O Operations**

* The **event loop** assigns non-blocking tasks (I/O operations, database queries, API calls) to **worker threads** (via libuv).
* Once a task is complete, the callback is pushed to the  **callback queue** .

### **ğŸ”¹ Step 3: Execution of Callbacks**

* The **event loop** processes callbacks from the queue  **once the main execution is complete** .
* This ensures that Node.js never blocks the thread.

---

## **5ï¸âƒ£ Key Features of Node.js Architecture**

### **ğŸ”¹ Single-Threaded, Non-Blocking I/O**

* Unlike traditional multi-threaded servers, **Node.js runs on a single thread** but can handle  **multiple requests asynchronously** .
* Example: **Non-blocking File Read**

```js
const fs = require("fs");

console.log("Start");

fs.readFile("example.txt", "utf8", (err, data) => {
  if (err) throw err;
  console.log(data);
});

console.log("End");
```

### **ğŸ”¹ Output:**

```
Start
End
<Contents of example.txt>
```

âœ” **Why?** The file read operation is async, so Node.js does not wait and moves on.

---

## **6ï¸âƒ£ Event Loop: The Heart of Node.js**

The **event loop** continuously checks the **call stack** and **callback queue** to execute functions.

### **ğŸ”¹ Event Loop Phases**

1ï¸âƒ£ **Timers Phase** â€“ Executes `setTimeout` and `setInterval` callbacks.

2ï¸âƒ£ **Pending Callbacks Phase** â€“ Executes I/O callbacks (excluding timers).

3ï¸âƒ£ **Idle/Prepare Phase** â€“ Internal tasks.

4ï¸âƒ£ **Poll Phase** â€“ Fetches new I/O events and executes them.

5ï¸âƒ£ **Check Phase** â€“ Executes `setImmediate` callbacks.

6ï¸âƒ£ **Close Callbacks Phase** â€“ Executes callbacks for closed connections.

### **ğŸ”¹ Example: Event Loop Execution Order**

```js
console.log("Start");

setTimeout(() => console.log("setTimeout"), 0);
setImmediate(() => console.log("setImmediate"));

console.log("End");
```

### **ğŸ”¹ Output (Order Matters!)**

```
Start
End
setImmediate
setTimeout
```

âœ” **Why?**

* `setImmediate()` executes before `setTimeout()` if no I/O operation is involved.

---

## **7ï¸âƒ£ Node.js vs Traditional Multi-threaded Architecture**

| Feature         | Node.js (Single-Threaded)    | Traditional Servers (Multi-Threaded)   |
| --------------- | ---------------------------- | -------------------------------------- |
| Execution Model | Event-driven, async          | Blocking, thread-based                 |
| Performance     | High (Handles many requests) | Medium (Limited by threads)            |
| Scalability     | High (Non-blocking)          | Medium (More threads = more resources) |
| Use Case        | APIs, real-time apps         | CPU-intensive tasks                    |

---

## **8ï¸âƒ£ Real-World Use Cases of Node.js Architecture**

âœ” **Real-time Apps** â€“ Chat applications, live notifications

âœ” **API Gateways** â€“ RESTful services, GraphQL APIs

âœ” **Streaming Services** â€“ Netflix, YouTube

âœ” **Microservices** â€“ Lightweight & scalable services

âœ” **Serverless Functions** â€“ Cloud functions, AWS Lambda

---

## **9ï¸âƒ£ Interview Questions on Node.js Architecture**

ğŸ”¸ **How does the event loop work in Node.js?**

ğŸ”¸ **What is libuv in Node.js?**

ğŸ”¸ **How does Node.js handle multiple requests on a single thread?**

ğŸ”¸ **Explain the different phases of the event loop.**

ğŸ”¸ **What is the difference between setTimeout and setImmediate?**

ğŸ”¸ **Why is Node.js considered non-blocking?**

ğŸ”¸ **Compare Node.js with a multi-threaded server.**

---

## **ğŸ”Ÿ Quick Revision Summary**

âœ” **Node.js = Single-threaded, event-driven, non-blocking I/O**

âœ” **Uses V8 Engine, libuv, Event Loop**

âœ” **Asynchronous I/O with callback handling**

âœ” **Efficient for real-time applications & APIs**

âœ” **Better scalability than traditional multi-threaded servers**
