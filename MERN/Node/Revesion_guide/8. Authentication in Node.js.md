# **ğŸ“Œ Authentication in Node.js (Interview Guide)**

## **1ï¸âƒ£ Introduction**

Authentication is the process of verifying the identity of a user or system. In Node.js applications, authentication is often implemented using token-based methods like **JWT (JSON Web Tokens)** or using **sessions** stored on the server. It ensures that only authorized users can access protected resources.

ğŸ‘‰ **Popular Authentication Methods:**

âœ… **JWT (JSON Web Tokens)** â€“ Stateless, client-side token

âœ… **Session-based** â€“ Server-side session storage

âœ… **OAuth2.0** â€“ Delegated authorization (used in social logins)

âœ… **Passport.js** â€“ Authentication middleware for Node.js

---

# **2ï¸âƒ£ JWT Authentication in Node.js**

**JWT** is a compact and self-contained way of securely transmitting information between parties as a JSON object. It is widely used for user authentication in modern web applications.

### **ğŸ”¹ Install Dependencies**

```sh
npm install jsonwebtoken bcryptjs
```

### **ğŸ”¹ Generating JWT Tokens**

```js
const jwt = require('jsonwebtoken');
const bcrypt = require('bcryptjs');

// Dummy user data for login
const user = { id: 1, username: 'alice', password: 'password123' };

const generateToken = (user) => {
    const token = jwt.sign(
        { userId: user.id, username: user.username },
        'your-secret-key', // Secret key for signing the token
        { expiresIn: '1h' } // Expiration time
    );
    return token;
};

// Example usage
const token = generateToken(user);
console.log('JWT Token:', token);
```

### **ğŸ”¹ Verifying JWT Tokens**

```js
const verifyToken = (token) => {
    jwt.verify(token, 'your-secret-key', (err, decoded) => {
        if (err) {
            console.log('Token verification failed');
        } else {
            console.log('Token verified:', decoded);
        }
    });
};

// Example usage
verifyToken(token);
```

---

# **3ï¸âƒ£ Session-based Authentication in Node.js**

In session-based authentication, the server creates a session and stores it on the server side, while the client stores a session ID in a cookie.

### **ğŸ”¹ Install Dependencies**

```sh
npm install express-session
```

### **ğŸ”¹ Session Setup**

```js
const express = require('express');
const session = require('express-session');
const app = express();

// Session configuration
app.use(session({
    secret: 'your-secret-key',
    resave: false,
    saveUninitialized: true,
    cookie: { secure: false } // For development, use 'secure: true' in production
}));

// Dummy login route
app.post('/login', (req, res) => {
    const { username, password } = req.body;
    if (username === 'alice' && password === 'password123') {
        req.session.user = { username: 'alice' }; // Store user in session
        res.send('Login successful');
    } else {
        res.send('Invalid credentials');
    }
});

// Dummy protected route
app.get('/dashboard', (req, res) => {
    if (req.session.user) {
        res.send('Welcome to the dashboard');
    } else {
        res.send('Please log in first');
    }
});

app.listen(3000, () => console.log('Server running on port 3000'));
```

---

# **4ï¸âƒ£ OAuth 2.0 Authentication in Node.js**

OAuth 2.0 is an authorization framework that allows third-party services to exchange tokens for authentication, commonly used for social logins (Google, Facebook, etc.).

### **ğŸ”¹ Install Dependencies**

```sh
npm install passport passport-google-oauth20
```

### **ğŸ”¹ Setup Google OAuth Strategy with Passport.js**

```js
const passport = require('passport');
const GoogleStrategy = require('passport-google-oauth20').Strategy;

passport.use(new GoogleStrategy({
    clientID: 'YOUR_GOOGLE_CLIENT_ID',
    clientSecret: 'YOUR_GOOGLE_CLIENT_SECRET',
    callbackURL: 'http://localhost:3000/auth/google/callback'
}, (accessToken, refreshToken, profile, done) => {
    // Save user profile to database or session
    return done(null, profile);
}));

// Express routes for OAuth login
app.get('/auth/google', passport.authenticate('google', { scope: ['profile', 'email'] }));

app.get('/auth/google/callback', passport.authenticate('google', { failureRedirect: '/' }), (req, res) => {
    res.send('Google login successful');
});
```

---

# **5ï¸âƒ£ Implementing Role-based Access Control (RBAC)**

RBAC restricts access to system resources based on user roles (e.g., Admin, User).

### **ğŸ”¹ Checking User Roles with JWT**

```js
const checkRole = (role) => {
    return (req, res, next) => {
        const token = req.headers.authorization?.split(' ')[1];
        if (!token) return res.status(403).send('Access denied');
      
        jwt.verify(token, 'your-secret-key', (err, decoded) => {
            if (err || decoded.role !== role) {
                return res.status(403).send('Access denied');
            }
            next();
        });
    };
};

// Example usage in a protected route
app.get('/admin', checkRole('admin'), (req, res) => {
    res.send('Welcome Admin');
});
```

---

# **6ï¸âƒ£ Common Authentication Libraries for Node.js**

| Library                   | Description                                                                   |
| ------------------------- | ----------------------------------------------------------------------------- |
| **Passport.js**     | Authentication middleware supporting multiple strategies (local, OAuth, etc.) |
| **JWT**             | JSON Web Token for stateless authentication                                   |
| **Bcrypt.js**       | Library for hashing passwords securely                                        |
| **Express-Session** | Middleware for session-based authentication                                   |

---

# **7ï¸âƒ£ Authentication Interview Questions**

ğŸ”¹ **What is JWT and how is it used for authentication?**

ğŸ”¹ **Explain session-based authentication in Node.js.**

ğŸ”¹ **What is OAuth 2.0 and how is it different from JWT?**

ğŸ”¹ **How would you implement role-based access control in Node.js?**

ğŸ”¹ **Why would you use Passport.js for authentication in a Node.js app?**

ğŸ”¹ **How do you handle password hashing and salting in Node.js?**

---

# **8ï¸âƒ£ Quick Revision Summary**

âœ” **JWT** â€“ Stateless, token-based authentication

âœ” **Session-based** â€“ Server-side session storage

âœ” **OAuth 2.0** â€“ Delegated authorization for third-party logins

âœ” **Passport.js** â€“ Authentication middleware with multiple strategies

âœ” **Role-based Access Control** â€“ Restrict access based on roles

âœ” **Bcrypt.js** â€“ Secure password hashing and salting
